// **App.razor**
// Dit bestand beheert de routing en autorisatie van de applicatie en zorgt voor een consistente gebruikerservaring.

@using Microsoft.AspNetCore.Components.Authorization // Ondersteunt autorisatie via claims en authenticatiestatus.
@using VivesRental.BlazorApp // Toegang tot applicatiespecifieke routes en componenten.
@inject NavigationManager NavigationManager // Injecteert NavigationManager voor navigatiefuncties.

<Router AppAssembly="@typeof(App).Assembly">
    <!-- Als een route wordt gevonden, voer deze uit: -->
    <Found Context="routeData">
        <AuthorizeRouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)">
            <!-- Controleer of de gebruiker geautoriseerd is: -->
            <NotAuthorized>
                @* Redirect naar de inlogpagina als de gebruiker niet geautoriseerd is *@
                @{
                    var signInRoute = AppRoutes.Account.SignIn;
                    var uri = NavigationManager.Uri; // Huidige URL van de gebruiker.
                    var baseUri = NavigationManager.BaseUri; // Basis-URL van de applicatie.
                    var relativeUrl = uri.Substring(baseUri.Length - 1, uri.Length - baseUri.Length + 1);
                    NavigationManager.NavigateTo($"{signInRoute}?returnUrl={relativeUrl}");
                }
            </NotAuthorized>
        </AuthorizeRouteView>
        <!-- Focus bij het navigeren naar een nieuwe pagina -->
        <FocusOnNavigate RouteData="@routeData" Selector="h1" />
    </Found>

    <!-- Als een route niet wordt gevonden: -->
    <NotFound>
        <PageTitle>Pagina Niet Gevonden</PageTitle>
        <LayoutView Layout="@typeof(MainLayout)">
            <p role="alert">Sorry, de gevraagde pagina bestaat niet.</p>
        </LayoutView>
    </NotFound>
</Router>
